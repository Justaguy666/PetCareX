@baseUrl = http://localhost:3001
@accessToken = eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjM1NTAyIiwicm9sZSI6IlF14bqjbiBsw70gY2hpIG5ow6FuaCIsImlhdCI6MTc2NjgxMDA1NywiZXhwIjoxNzY2ODEwOTU3fQ.7bg2TWGlJHrPvXCKnFd29YgaBuLbW4qeiFsQi-4K1Fw
@employeeToken = eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjM1NTAxIiwicm9sZSI6IkLDoWMgc8SpIHRow7ogeSIsImlhdCI6MTc2NjgyOTQ1MCwiZXhwIjoxNzY2ODMwMzUwfQ.AFOP7di8SDMtP-kuEObWxaak5zMinTHwhkNbODx20jo
@receptionistToken = eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjM1NTAyIiwicm9sZSI6Ik5ow6JuIHZpw6puIHRp4bq_cCB0w6JuIiwiaWF0IjoxNzY2ODI4NDcwLCJleHAiOjE3NjY4MjkzNzB9.1Wv8P37jZBRKHTjzO0nblL6mG1NUXPS8Nhz--M2wam0
@customerId = 35001
@petId = 35002
@branchId = 1
@doctorId = 501
POST {{baseUrl}}/api/auth/register
Content-Type: application/json

{
  "email": "test+manager@example.com",
  "username": "test_manager",
  "password": "P@ssw0rd123"
}

###

### Login (returns cookies `accessToken` and `refreshToken`)
POST {{baseUrl}}/api/auth/login
Content-Type: application/json

{
  "username": "test_manager_db",
  "password": "Manager@1234"
}

###

### Me (optional)
GET {{baseUrl}}/api/auth/me
Content-Type: application/json
Cookie: accessToken={{accessToken}}

###

### Manager endpoint (requires `manager` role)
GET {{baseUrl}}/api/manager/statistics/revenue/branch
Content-Type: application/json
Cookie: accessToken={{accessToken}}

###

# Notes:
# - `register` creates a regular customer account by default; to test manager-only routes you must login with an account that has `account_type` set to a manager role in the database.
# - You can promote an account to manager directly in the DB (update `accounts.account_type`) or use an existing seeded manager user.

### Test: appointments sequence
# 1) Login as manager (run this, then copy the accessToken cookie value into the top `@accessToken` variable)
POST {{baseUrl}}/api/auth/login
Content-Type: application/json

{
  "username": "test_manager_db",
  "password": "Manager@1234"
}

###

# 2) Call appointments stats (no branch)
GET {{baseUrl}}/api/manager/statistics/products
Content-Type: application/json
Cookie: accessToken={{accessToken}}

###

# 3) Call appointments stats (with branch id)
GET {{baseUrl}}/api/manager/statistics/products/51
Content-Type: application/json
Cookie: accessToken={{accessToken}}

###

### Manager — Product revenue statistics
# Get revenue from products (all branches)
GET {{baseUrl}}/api/manager/statistics/products
Content-Type: application/json
Cookie: accessToken={{accessToken}}

###

# Get revenue from products for a specific branch
GET {{baseUrl}}/api/manager/statistics/products/1
Content-Type: application/json
Cookie: accessToken={{accessToken}}

###

### Branches — public endpoints
# Get all branches
GET {{baseUrl}}/api/branch
Content-Type: application/json
Cookie: accessToken={{accessToken}}

###

# Get branch by id
GET {{baseUrl}}/api/branch/50
Content-Type: application/json
Cookie: accessToken={{accessToken}}

###
# New accounts: login as employee (created by test script)
POST {{baseUrl}}/api/auth/login
Content-Type: application/json

{
  "username": "test_employee",
  "password": "Employee@1234"
}

###

### Login receptionist (created by test script)
POST {{baseUrl}}/api/auth/login
Content-Type: application/json

{
  "username": "test_receptionist",
  "password": "Reception@1234"
}

###

### Pet — List all pets (use `employeeToken` cookie after login)
GET {{baseUrl}}/api/pets
Content-Type: application/json
Cookie: accessToken={{employeeToken}}

### Pet — List all pets (paginated, with keyword)
# Example: page 2, 5 items per page, keyword search for owner's name or pet name
GET {{baseUrl}}/api/pets?page=2&pageSize=5&keyword=Fido
Content-Type: application/json
Cookie: accessToken={{employeeToken}}

### Pet — List all pets (first page, default pageSize)
GET {{baseUrl}}/api/pets?page=1&pageSize=10
Content-Type: application/json
Cookie: accessToken={{employeeToken}}

### Pet — Keyword search by owner name (example Vietnamese name)
GET {{baseUrl}}/api/pets?keyword=Nguyễn&page=1&pageSize=5
Content-Type: application/json
Cookie: accessToken={{employeeToken}}

### Pet — No results (page out of range / unlikely keyword)
GET {{baseUrl}}/api/pets?page=999&pageSize=10&keyword=noresults12345
Content-Type: application/json
Cookie: accessToken={{employeeToken}}

### Pet — Get pet by id (use `employeeToken` cookie after login)
GET {{baseUrl}}/api/pets/{{petId}}
Content-Type: application/json
Cookie: accessToken={{employeeToken}}

###

### Appointment — Create appointment (use `receptionistToken` cookie after login)
POST {{baseUrl}}/api/appointments
Content-Type: application/json
Cookie: accessToken={{receptionistToken}}

{
  "customer_id": {{customerId}},
  "pet_id": {{petId}},
  "branch_id": {{branchId}},
  "doctor_id": {{doctorId}},
  "appointment_time": "2026-01-24T09:30:00.000Z"
}

